<?xml version='1.0' encoding='utf-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
  <head>
    <meta content='GROW UP' http-equiv='X-UA-Compatible' />
    <meta content='width=850' name='viewport' />
    <title>GusG.us - Rails 2: Inflection for Address</title>
    <link href='/images/gusgus_icon.gif' rel='icon' />
    <link href="http://feeds.feedburner.com/gusgus" rel="alternate" title="GusG.us" type="application/atom+xml" />
    <link href='http://gusg.us/feed.xml' rel='alternate' title='GusG.us' type='application/atom+xml' />
    <link href="/stylesheets/reset-min.css" type="text/css" media="screen" rel="stylesheet"/>
    <link href="/stylesheets/application.css" type="text/css" media="screen" rel="stylesheet"/>
    <link href="/stylesheets/pygment-native.css" type="text/css" media="screen" rel="stylesheet"/>
  </head>

  <body>
    <div class='container'>
      <div id='header'>
        <div id='nav'>
          <ul>
            <li><a href='/'>Home</a></li>
            <li class=""><a href='/life'>Life</a></li>
            <li><a href='/work'>Work</a></li>
            <li><a href='/code'>Code</a></li>
            <li><a href='/code/ruby'>Ruby</a></li>
          </ul>
        </div>
        <div id="slogan" class="clear"><img src="/images/gus-slogan.png" align="center"></div>
      </div>

      <div id="article">
  <div class="header">
    <h1>Rails 2: Inflection for Address</h1>
    <div class="date"><cite>Oct 16, 2008</cite></div>
    <div class="summary">Learning something new about Rails everyday</div>
    <div class="clear"></div>
  </div>
  <p>Hey! I added an ActiveRecord model to a project today named <code>Address</code>. It&#8217;s exactly what you think it is and I want my Contacts in this project to have many addresses.</p>

<p>Because we&#8217;re so hip and cool on this project, we&#8217;re using Thoughbot&#8217;s <a href='http://github.com/thoughtbot/factory_girl/tree/master'>Factory Girl</a> gem. Yeah. So, I ran my tests and BAM! got this error:</p>

<pre><code>1) Error:
    test: when something something something something &quot;Address.count&quot; from 1 to 0. (ContactTest):
    NameError: uninitialized constant Addres</code></pre>

<p>Which can be traced to line 226 of Factory Girl&#8217;s <a href='http://github.com/thoughtbot/factory_girl/tree/master/lib/factory_girl/factory.rb'>factory.rb</a> file, which does the following:</p>
<div class='highlight'><pre><span class='k'>if</span> <span class='n'>class_or_to_s</span><span class='o'>.</span><span class='n'>respond_to?</span><span class='p'>(</span><span class='ss'>:to_sym</span><span class='p'>)</span>
  <span class='n'>class_or_to_s</span><span class='o'>.</span><span class='n'>to_s</span><span class='o'>.</span><span class='n'>classify</span><span class='o'>.</span><span class='n'>constantize</span>
<span class='k'>else</span>
  <span class='o'>.</span><span class='n'>.</span><span class='o'>.</span>
</pre>
</div>
<p>Seems simple enough to solve. Perhaps we should change the inflector rules to &#8230; say &#8230; this:</p>
<div class='highlight'><pre><span class='no'>ActiveSupport</span><span class='o'>::</span><span class='no'>Inflector</span><span class='o'>.</span><span class='n'>inflections</span> <span class='k'>do</span> <span class='o'>|</span><span class='n'>inflect</span><span class='o'>|</span>
  <span class='n'>inflect</span><span class='o'>.</span><span class='n'>plural</span><span class='sr'> /(ss)$/i</span><span class='p'>,</span> <span class='s1'>&#39;\1es&#39;</span>
  <span class='n'>inflect</span><span class='o'>.</span><span class='n'>singular</span><span class='sr'> /(ss)es$/i</span><span class='p'>,</span> <span class='s1'>&#39;\1&#39;</span>
<span class='k'>end</span>
</pre>
</div>
<p>Yeah &#8230; no! Still didn&#8217;t work. Went out to eat. Came back. Tried this stupid, stupid, stupid thing and &#8230; well &#8230; it worked:</p>
<div class='highlight'><pre><span class='no'>ActiveSupport</span><span class='o'>::</span><span class='no'>Inflector</span><span class='o'>.</span><span class='n'>inflections</span> <span class='k'>do</span> <span class='o'>|</span><span class='n'>inflect</span><span class='o'>|</span>
  <span class='n'>inflect</span><span class='o'>.</span><span class='n'>singular</span><span class='sr'> /(ss)$/i</span><span class='p'>,</span> <span class='s1'>&#39;\1&#39;</span>
<span class='k'>end</span>
</pre>
</div>
<p>Barf again!</p>

<p>Hopefully nothing else is broken now.</p>
</div>


    </div>
    <div class='container'>
      <div class='clear' id='footer'>
        &copy; 2007 - 2009 Justin Knowlden,
        <span class='email'>gus at gusg dot us</span>
        <span class='powered'>
          - Powered by <a href=''>Jekyll</a>,
          <a href='http://daringfireball.net/projects/markdown/'>Markdown</a>,
          <a href='http://pygments.org/'>Pygments</a>, and me
        </span>
        <a href="http://feeds2.feedburner.com/gusgus" rel="alternate" type="application/rss+xml">
          <img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="vertical-align:middle;border:0"/></a>
      </div>
    </div>
    <script src="http://ajax.googleapis.com/ajax/libs/prototype/1.6.0.3/prototype.js" type="text/javascript"></script>
    <script src="/javascripts/jquery-1.2.6.min.js" type="text/javascript"></script>
    <script src="http://grumble.annealer.org/javascripts/grumbler/api.js" type="text/javascript"></script>
    <script src="/javascripts/grumble_support.js" type="text/javascript"></script>
  </body>
</html>